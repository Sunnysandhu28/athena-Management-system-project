{% extends 'action_plan_steps/base_wizard.html' %}

{% set current_step = 5 %}
{% set progress_percentage = 100 %}

{% block step_title %}Review & Confirmation{% endblock %}
{% block step_description %}Review all the information and confirm the action plan details.{% endblock %}
{% block form_action %}/action-plans/submit{% endblock %}

{% block step_content %}
<div class="alert alert-info mb-4">
    <h5><i class="bi bi-info-circle"></i> Action Plan Summary</h5>
    <p>Please review the information below to ensure it's correct before submitting.</p>
</div>

<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">Inspection Details</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <p><strong>Inspection Date:</strong> <span id="summary-inspection-date"></span></p>
                <p><strong>Requirement Type:</strong> <span id="summary-requirement-type"></span></p>
            </div>
            <div class="col-md-6">
                <p><strong>Urgency Level:</strong> <span id="summary-urgency"></span></p>
                <p><strong>Associated Files:</strong> <span id="summary-files"></span></p>
            </div>
        </div>
    </div>
</div>

<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">Action Plan Details</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <p><strong>Action Plan Title:</strong> <span id="summary-title"></span></p>
                <p><strong>Priority Level:</strong> <span id="summary-priority"></span></p>
                <p><strong>Target Completion:</strong> <span id="summary-target-date"></span></p>
            </div>
            <div class="col-md-6">
                <p><strong>Regulatory Areas:</strong> <span id="summary-regulations"></span></p>
                <p><strong>Lead Person:</strong> <span id="summary-lead"></span></p>
                <p><strong>Department:</strong> <span id="summary-department"></span></p>
            </div>
        </div>
        <div class="mt-3">
            <p><strong>Description:</strong></p>
            <p id="summary-description" class="border-bottom pb-2"></p>
            
            <p><strong>Required Actions:</strong></p>
            <p id="summary-actions" class="border-bottom pb-2"></p>
            
            <p><strong>Evidence Required:</strong></p>
            <p id="summary-evidence"></p>
        </div>
    </div>
</div>

<div class="mb-4">
    <div class="form-check">
        <input class="form-check-input" type="checkbox" id="confirmAccurate" name="confirmAccurate" required>
        <label class="form-check-label" for="confirmAccurate">
            I confirm that the information provided is accurate and complete
        </label>
    </div>
</div>

<div class="mb-4">
    <div class="form-check">
        <input class="form-check-input" type="checkbox" id="agreeUpdates" name="agreeUpdates" required>
        <label class="form-check-label" for="agreeUpdates">
            I agree to provide regular updates on the progress of this action plan
        </label>
    </div>
</div>

<script>
    // This would be populated with actual session data in a real implementation
    document.addEventListener('DOMContentLoaded', function() {
        // For demonstration, we'll use placeholders
        document.getElementById('summary-inspection-date').textContent = "May 14, 2025";
        document.getElementById('summary-requirement-type').textContent = "CQC Inspection";
        document.getElementById('summary-urgency').textContent = "High";
        document.getElementById('summary-files').textContent = "InspectionReport.pdf";
        
        document.getElementById('summary-title').textContent = "CQC Regulation 12 Compliance Plan";
        document.getElementById('summary-priority').textContent = "High";
        document.getElementById('summary-target-date').textContent = "June 14, 2025";
        document.getElementById('summary-regulations').textContent = "CQC Reg 12, 17; Fire Safety";
        document.getElementById('summary-lead').textContent = "Jane Smith";
        document.getElementById('summary-department').textContent = "Care Team";
        
        document.getElementById('summary-description').textContent = "Non-compliance with medication management procedures as identified in the recent CQC inspection.";
        document.getElementById('summary-actions').textContent = "1. Update medication management policy\n2. Retrain all staff\n3. Implement new medication audit procedures";
        document.getElementById('summary-evidence').textContent = "Updated policies, training records, audit results, staff competency assessments";
    });
</script>
{% endblock %}